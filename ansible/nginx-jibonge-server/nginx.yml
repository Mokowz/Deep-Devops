---
- name: Installation of nginx
  hosts: all
  become: true

  tasks:
  - name: Install nginx
    apt:
      name: nginx
      state: latest
      update_cache: true

  - name: Update the UFW firewall
    shell:
      cmd: ufw allow 'Nginx Full'

  - name: Configure the nginx server
    template:
      src: nginx_conf
      dest: /etc/nginx/sites-available/jibonge

  - name: Create a symbolic link
    shell:
      cmd: ln -s /etc/nginx/sites-available/jibonge /etc/nginx/sites-enabled


  - name: Test and Restart Nginx
    shell: 
      cmd: nginx -t && systemctl restart nginx
